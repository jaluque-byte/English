<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Irregular Verbs Challenge (B2) – Timed Leaderboard</title>
  <style>
    body {font-family: Arial, sans-serif; background-color: #0f172a; color: #e5e7eb; margin: 0; padding: 20px;}
    h1 {text-align: center; color: #22c55e;}
    .card {background-color: #1e293b; border-radius: 10px; padding: 20px; margin: 20px auto; max-width: 600px;}
    .prompt {font-size: 1.2em; margin-bottom: 10px;}
    input {width: 100%; padding: 10px; font-size: 1em; border-radius: 5px; border: none; margin-bottom: 10px;}
    button {padding: 10px 15px; font-size: 1em; border: none; border-radius: 8px; cursor: pointer;}
    .btn-primary {background-color: #2563eb; color: white;}
    .btn-secondary {background-color: #16a34a; color: white;}
    .btn-warning {background-color: #f59e0b; color: white;}
    .feedback {font-weight: bold; margin-top: 10px;}
    .good {color: #22c55e;}
    .bad {color: #ef4444;}
    .scoreboard {display: flex; justify-content: space-around; margin-top: 15px;}
    .score {background-color: #111827; border-radius: 10px; padding: 10px 20px; text-align: center;}
    .timer {font-size: 1.2em; font-weight: bold; color: #fbbf24; text-align: center;}
    #leaderboard {background-color: #111827; padding: 15px; border-radius: 10px; margin-top: 20px;}
    table {width: 100%; border-collapse: collapse;}
    th, td {border-bottom: 1px solid #334155; padding: 8px; text-align: center;}
  </style>
</head>
<body>
  <h1>Irregular Verbs Challenge (B2) ⚡</h1>
  <div class="card">
    <div class="timer">⏱️ Time left: <span id="time">60</span> s</div>
    <div class="prompt" id="prompt">Base form: <strong>go</strong></div>
    <input type="text" id="past" placeholder="Enter Past Simple (e.g. went)">
    <input type="text" id="participle" placeholder="Enter Past Participle (e.g. gone)">
    <button class="btn-primary" id="check">Check</button>
    <button class="btn-secondary" id="next">Next</button>
    <button class="btn-warning" id="restart">Restart</button>
    <div class="feedback" id="feedback"></div>
    <div class="scoreboard">
      <div class="score">✅ Correct: <span id="correct">0</span></div>
      <div class="score">❌ Incorrect: <span id="incorrect">0</span></div>
      <div class="score">🎯 Accuracy: <span id="accuracy">0%</span></div>
    </div>
  </div>


  <div id="leaderboard" hidden>
    <h2>🏆 Leaderboard</h2>
    <table>
      <thead><tr><th>Rank</th><th>Name</th><th>Score</th><th>Accuracy</th></tr></thead>
      <tbody id="leaderboard-body"></tbody>
    </table>
  </div>


  <script>
    const verbs = [
      {base: 'go', past: ['went'], part: ['gone']},
      {base: 'see', past: ['saw'], part: ['seen']},
      {base: 'take', past: ['took'], part: ['taken']},
      {base: 'begin', past: ['began'], part: ['begun']},
      {base: 'choose', past: ['chose'], part: ['chosen']},
      {base: 'write', past: ['wrote'], part: ['written']},
      {base: 'eat', past: ['ate'], part: ['eaten']},
      {base: 'break', past: ['broke'], part: ['broken']},
      {base: 'fall', past: ['fell'], part: ['fallen']},
      {base: 'drive', past: ['drove'], part: ['driven']},
      {base: 'forget', past: ['forgot'], part: ['forgotten']},
      {base: 'swim', past: ['swam'], part: ['swum']},
      {base: 'sing', past: ['sang'], part: ['sung']},
      {base: 'fly', past: ['flew'], part: ['flown']},
      {base: 'grow', past: ['grew'], part: ['grown']}
    ];


    let index = 0, correct = 0, incorrect = 0, time = 60, timer, gameOver = false;
    const prompt = document.getElementById('prompt');
    const pastInput = document.getElementById('past');
    const partInput = document.getElementById('participle');
    const feedback = document.getElementById('feedback');
    const correctSpan = document.getElementById('correct');
    const incorrectSpan = document.getElementById('incorrect');
    const accuracySpan = document.getElementById('accuracy');
    const timeSpan = document.getElementById('time');


    function loadVerb() {
      const verb = verbs[index];
      prompt.innerHTML = `Base form: <strong>${verb.base}</strong>`;
      pastInput.value = '';
      partInput.value = '';
      feedback.textContent = '';
      pastInput.focus();
    }


    function checkAnswer() {
      if (gameOver) return;
      const verb = verbs[index];
      const past = pastInput.value.trim().toLowerCase();
      const part = partInput.value.trim().toLowerCase();
      const pastCorrect = verb.past.includes(past);
      const partCorrect = verb.part.includes(part);
      if (pastCorrect && partCorrect) {
        feedback.innerHTML = `<span class='good'>✅ Correct!</span>`;
        correct++;
      } else {
        feedback.innerHTML = `<span class='bad'>❌ Incorrect.</span> Correct: <em>${verb.past.join(', ')} / ${verb.part.join(', ')}</em>`;
        incorrect++;
      }
      updateScore();
    }


    function nextVerb() {
      if (gameOver) return;
      index = (index + 1) % verbs.length;
      loadVerb();
    }


    function updateScore() {
      correctSpan.textContent = correct;
      incorrectSpan.textContent = incorrect;
      const total = correct + incorrect;
      const accuracy = total > 0 ? Math.round((correct / total) * 100) : 0;
      accuracySpan.textContent = accuracy + '%';
    }


    function startTimer() {
      timer = setInterval(() => {
        time--;
        timeSpan.textContent = time;
        if (time <= 0) endGame();
      }, 1000);
    }


    function endGame() {
      gameOver = true;
      clearInterval(timer);
      feedback.innerHTML = `<span class='bad'>⏰ Time's up!</span>`;
      saveToLeaderboard();
    }


    function saveToLeaderboard() {
      const player = promptName();
      const total = correct + incorrect;
      const accuracy = total > 0 ? Math.round((correct / total) * 100) : 0;
      const record = {name: player, score: correct, accuracy};
      const data = JSON.parse(localStorage.getItem('irregularLeaderboard') || '[]');
      data.push(record);
      data.sort((a,b) => b.score - a.score || b.accuracy - a.accuracy);
      localStorage.setItem('irregularLeaderboard', JSON.stringify(data.slice(0,10)));
      showLeaderboard();
    }


    function promptName() {
      let name = prompt('Enter your name for the leaderboard:');
      return name ? name.trim() : 'Anonymous';
    }


    function showLeaderboard() {
      const list = JSON.parse(localStorage.getItem('irregularLeaderboard') || '[]');
      const tbody = document.getElementById('leaderboard-body');
      tbody.innerHTML = list.map((r,i)=>`<tr><td>${i+1}</td><td>${r.name}</td><td>${r.score}</td><td>${r.accuracy}%</td></tr>`).join('');
      document.getElementById('leaderboard').hidden = false;
    }


    function restartGame() {
      correct = incorrect = 0; time = 60; gameOver = false;
      updateScore();
      document.getElementById('leaderboard').hidden = true;
      clearInterval(timer);
      startTimer();
      loadVerb();
    }


    document.getElementById('check').addEventListener('click', checkAnswer);
    document.getElementById('next').addEventListener('click', nextVerb);
    document.getElementById('restart').addEventListener('click', restartGame);
    window.addEventListener('keydown', e => { if (e.key === 'Enter') checkAnswer(); });


    loadVerb();
    startTimer();
  </script>
</body>
</html>